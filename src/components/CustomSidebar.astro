---
const path = Astro.url.pathname;

// Get current sidebar from Starlight runtime
let sidebar = Astro.locals.starlightRoute?.sidebar ?? [];

// Filter items per path
if (path.startsWith('/truetech/')) {
  sidebar = sidebar.filter((item: any) => item.autogenerate?.directory?.startsWith('truetech'));
} else if (path.startsWith('/gamingforge/')) {
  sidebar = sidebar.filter((item: any) => item.autogenerate?.directory?.startsWith('gamingforge'));
} else if (path.startsWith('/lifeforge/')) {
  sidebar = sidebar.filter((item: any) => item.autogenerate?.directory?.startsWith('lifeforge'));
} else {
  sidebar = sidebar.filter((item: any) => 
    !item.autogenerate?.directory?.includes('truetech') &&
    !item.autogenerate?.directory?.includes('gamingforge') &&
    !item.autogenerate?.directory?.includes('lifeforge')
  );
}
---

<SidebarPersister>
  <SidebarSublist sublist={sidebar} />
</SidebarPersister>

<MobileMenuFooter class="md:sl-hidden" />
